# サブスクリプション UX要件

**最終更新**: 2025-11-29

---

## 🎯 絶対に守るべきUX原則

### 1. 即時反映
決済完了後、即座に新プランの機能が使える。
「反映まで数分お待ちください」は絶対NG。

**理由**: ユーザーが「本当に決済できたか不安」にならないため。

**具体的な要件**:
- Stripe Checkout完了 → Webhook処理 → DB更新 → フロントエンド更新
- この一連の流れが3秒以内に完了
- ユーザーがリロードしなくても画面が更新される

---

### 2. 即座のフィードバック
ボタンをクリックしたら、0.1秒以内に何かしらの反応がある。

**理由**: 「ボタン押したのに反応ない」→「もう一回押そう」→2重クリック防止のため。

**具体的な要件**:
- ボタンクリック → ローディングスピナー表示
- ボタンが無効化される（連打防止）
- 「処理中...」などの状態表示

---

### 3. 2重課金の絶対防止
どんな操作をしても2重課金は絶対に起きない。

**理由**: ユーザーの信頼を失わないため。1回でも2重課金が起きたら大問題。

**具体的な要件**:
- プラン変更時、古いプランは自動キャンセル
- ボタン連打しても1回しか処理されない
- Webhook冪等性チェック（同じイベントを複数回受信しても1回だけ処理）

---

### 4. 分かりやすいエラーメッセージ
エラーは日本語で、次に何をすべきか明確。

**理由**: 「Error: 500」だけ表示されても、ユーザーは何もできない。

**具体的な要件**:
```
❌ Bad:
"Error: payment_intent_creation_failed"

✅ Good:
「決済に失敗しました。
カード情報を確認して、もう一度お試しください。
問題が続く場合は、サポートにお問い合わせください。」
```

---

### 5. 明確な状態表示
「今どういう状態か」が常に分かる。

**理由**: 「プラン変更したのに表示が変わらない」という不安を防ぐため。

**具体的な要件**:
- 現在のプラン名が常に表示される
- 次回更新日が表示される
- キャンセル予約中の場合は「〇〇日まで利用可能」と表示

---

## 💰 料金表示の要件

### 1. 正確な金額表示
税込・税抜を明確に。

**具体的な要件**:
- 月額 ¥1,980（税込）
- 年額 ¥19,800（税込）
- 「税込」の表記は必須

---

### 2. プラン変更時の日割り計算
アップグレード時は日割り計算された金額を明示。

**具体的な要件**:
```
例: Starter (¥1,980/月) → Premium (¥4,980/月)
     残り15日の場合:
     
「今すぐ ¥2,419 が請求されます
（Premiumプランの日割り分）」
```

---

### 3. 次回請求額の明示
次にいくら請求されるか分かる。

**具体的な要件**:
```
現在のプラン: Premium
次回更新日: 2025-12-29
次回請求額: ¥4,980（税込）
```

---

## 🔄 プラン変更の要件

### 1. アップグレードは即時反映
より高額なプランへの変更は即座に反映。

**理由**: ユーザーが「すぐに使いたい」という期待があるため。

---

### 2. ダウングレードは次回更新時
より安いプランへの変更は次回更新日から。

**理由**: 
- 返金処理が複雑になるのを避ける
- 「払ったのに使えない」というクレームを防ぐ

**具体的な要件**:
```
確認メッセージ例:
「Starterプランへの変更を予約しました。
2025-12-29からStarterプランに変更されます。
それまではPremiumプランの機能を引き続きご利用いただけます。」
```

---

### 3. キャンセルは次回更新時
プランキャンセルも次回更新日まで利用可能。

**理由**: 
- 「払ったのにすぐ使えなくなった」というクレームを防ぐ

**具体的な要件**:
```
キャンセル後の表示例:
「プランをキャンセルしました。
2025-12-29まで引き続きご利用いただけます。」
```

---

## 📱 レスポンシブ対応

### 1. モバイルファースト
スマホで快適に使える。

**具体的な要件**:
- プラン一覧がスマホでスクロールしやすい
- ボタンが指で押しやすいサイズ
- 料金表示が見切れない

---

### 2. タブレット対応
タブレットでも快適に使える。

---

## ⚡ パフォーマンス要件

### 1. ページ読み込み
/subscriptionページは3秒以内に表示。

---

### 2. Checkoutリダイレクト
ボタンクリックからCheckoutページ表示まで2秒以内。

---

### 3. Webhook処理
Webhook受信からDB更新完了まで5秒以内。

---

## 🔒 セキュリティ要件（UX視点）

### 1. 安心感のある決済
StripeのCheckoutを使用（カード情報を自サイトで扱わない）。

**理由**: ユーザーが「カード情報を入力しても大丈夫か」と不安にならないため。

---

### 2. メール確認
決済完了・プラン変更時には必ずメール通知。

**理由**: 「本当に処理されたか」をメールで確認できる安心感。

---

## 📧 メール通知の要件

### 1. 決済完了メール
**件名**: 「【BONO Training】決済が完了しました」

**内容**:
- プラン名
- 金額
- 次回更新日
- サポート連絡先

---

### 2. プラン変更メール
**件名**: 「【BONO Training】プランが変更されました」

**内容**:
- 変更前のプラン
- 変更後のプラン
- 変更日時
- 次回更新日

---

### 3. キャンセルメール
**件名**: 「【BONO Training】プランをキャンセルしました」

**内容**:
- キャンセルしたプラン
- 利用可能期限
- 再登録方法

---

## 🎨 デザイン要件（UX視点）

### 1. 視覚的階層
現在のプランが一目で分かる。

**具体的な要件**:
- 現在のプランには「現在のプラン」バッジ
- 他のプランとの視覚的な差別化

---

### 2. CTAボタン
「このプランを選択」ボタンが目立つ。

**具体的な要件**:
- 大きく
- 色で差別化
- ホバー時のアニメーション

---

### 3. ローディング状態
処理中であることが明確。

**具体的な要件**:
- スピナー表示
- 「処理中...」テキスト
- ボタン無効化

---

**これらのUX要件を満たすことで、ユーザーは安心してサブスクリプションを利用できます。**
