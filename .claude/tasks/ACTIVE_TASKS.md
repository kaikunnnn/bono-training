# アクティブタスク一覧

**最終更新**: 2026-02-05
**目的**: 現在進行中のタスクを一元管理

---

## 📌 使い方

「今やるべきタスクは？」と聞かれたら、このファイルを確認してください。

---

## 🚨 Critical Issues (優先度: 最高)

**現在なし** - サブスクリプション再構築プロジェクト完了

---

## ⚠️ High Priority Tasks

### 1. サブスクリプション: UX改善（ISSUE-P3-005, 006）

**ステータス**: ⏳ 未対応
**優先度**: ⚠️ HIGH
**担当**: AI開発チーム
**詳細ドキュメント**: [MASTER-PLAN.md](../docs/subscription/redesign/MASTER-PLAN.md)

**問題概要**:

1. **ISSUE-P3-005: /account反映遅延**
   - プラン変更後、/accountに遷移しても古いデータが表示される
   - リロードで反映される
   - 原因: コンテキストのキャッシュが更新されていない

2. **ISSUE-P3-006: モーダル15秒ローディング**
   - プラン変更API成功後、モーダルのローディングが15秒続く
   - 原因: Realtime検出タイムアウト（15秒）を待っている

**次のアクション**:
- [ ] プラン変更成功時にコンテキストを強制リフレッシュ
- [ ] API成功後すぐに遷移する（Realtime検出を待たない）

---

### 2. データマイグレーション: 失敗ユーザー調査

**ステータス**: 📋 TODO
**優先度**: 🟡 MEDIUM
**担当**: AI開発チーム
**作成日**: 2025-11-26

**問題概要**:
ユーザー作成マイグレーションで121名のユーザーが失敗。以下の3パターンに分類される:

1. **既存ユーザーエラー (87件)**: `A user with this email address has already been registered`
   - 実質的には問題なし

2. **Database error (6件)**: `Database error creating new user`
   - 🔴 **要調査**: データベース整合性の確認が必要

3. **HTML レスポンス (1件)**: `Unexpected token '<', "<html>..."`
   - 手動再試行が必要

4. **空のエラー (1件)**: `{}`
   - 手動再試行が必要

**関連ファイル**:
- エラーログ: `migration-errors-auth.json`

---

### 3. みんなの質問（Q&A）機能のモックアップ作成

**ステータス**: 📋 TODO
**優先度**: 🟡 MEDIUM
**担当**: AI開発チーム
**作成日**: 2026-02-05

**概要**:
グローバルナビゲーションに「みんなの質問」を追加し、質問投稿と「1ユーザー1回コメント」の体験を確認できるモックアップを作成する。

**詳細ドキュメント**:
- [phase6-community-questions.md](./phase6-community-questions.md)

---

## ✅ 完了済みタスク（直近7日間）

### サブスクリプション再構築プロジェクト

**完了日**: 2025-12-01
**詳細**: [MASTER-PLAN.md](../docs/subscription/redesign/MASTER-PLAN.md)

**実装内容**:
- ✅ Phase 0: 緊急現状精査 - 全ての問題を特定
- ✅ Phase 1: 実際の動作テスト - 新規登録・プラン変更成功
- ✅ Phase 1.5: 緊急修正 - 環境変数問題解決
- ✅ Phase 2: 問題の修正 - タイムアウト改善・UX改善
- ✅ Phase 3: 全体動作確認 - 全フロー正常動作確認
- ✅ Phase 4: ドキュメント更新

**テスト結果**:
- ✅ 新規登録（Standard/Feedback）
- ✅ プラン変更（アップグレード/ダウングレード/期間変更）
- ✅ キャンセル（期間終了まで利用可能）

**修正した問題**:
- ISSUE-P3-001: canceled_atカラム追加
- ISSUE-P3-004: 期間変更「同じプラン」判定修正

**残課題**:
- ISSUE-P3-005, 006（上記参照）

---

### サブスクリプション: キャンセル後アクセス機能

**完了日**: 2025-11-26
**詳細**: [cancelled-subscription-access-issue.md](../docs/subscription/issues/cancelled-subscription-access-issue.md)

**実装内容**:
- ✅ `calculateAccessPermissions` 関数を修正
- ✅ `cancel_at_period_end: true` でも `current_period_end` までアクセス可能に変更
- ✅ check-subscription Edge Function をデプロイ済み

---

## 📅 Backlog（優先度順）

**現在なし**

---

## 🎯 今日やるべきこと

**優先順位**:
1. ⚠️ **サブスクリプション: UX改善**（タスク#1）
   - /account反映遅延の修正
   - モーダルローディング改善
2. 🟡 **データマイグレーション: 失敗ユーザー調査**（タスク#2）
   - Database error 6名の確認
3. 🟡 **みんなの質問（Q&A）機能のモックアップ作成**（タスク#3）
   - ナビ追加・一覧・詳細・投稿のモック作成

---

## 📝 タスク管理ルール

### タスクの追加

新しいタスクが発生したら:
1. このファイルに追加
2. 優先度を設定（🔴 CRITICAL / ⚠️ HIGH / 🟡 MEDIUM / 🟢 LOW）
3. 詳細ドキュメントがある場合はリンクを追加

### タスクの完了

タスク完了時:
1. 「完了済みタスク」セクションに移動
2. 完了日を記録
3. 関連する詳細ドキュメントを更新

### 定期クリーンアップ

7日以上前に完了したタスクは削除してOK（詳細ドキュメントは残す）

---

**作成日**: 2025-11-26
**最終更新**: 2025-12-01
**管理者**: AI開発チーム
**目的**: 「今やるべきタスクは？」という質問に即答できる仕組み
