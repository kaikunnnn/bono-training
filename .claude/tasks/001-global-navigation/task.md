# タスク: グローバルナビゲーションの改善

## 実装概要
ヘッダータイプのグローバルナビゲーションをサイドナビゲーションタイプに変更し、UI/UXを改善する。

## 実装ステップ

### 1. プロジェクトの構造と現在のナビゲーション実装を分析
- [x] 現在のヘッダーナビゲーションのコンポーネント構造を確認
- [x] 使用しているフレームワーク/ライブラリを確認
- [x] ルーティングシステムの確認
- [x] 認証システムの確認

### 2. Figmaデザインをレビューして仕様を確認
- [x] デスクトップ版サイドナビゲーションのデザイン確認
- [x] コンポーネントスタイルの詳細確認（グループラベル、ナビ項目）
- [x] カラー、スペーシング、タイポグラフィの確認

### 3. サイドナビゲーションのコンポーネント構造を設計
- [x] コンポーネントの階層構造を定義
- [x] 必要なpropsとstateを定義
- [x] スタイリング方法を決定（Tailwind CSS使用）

### 4. BONOロゴをSVGファイルとして保存
- [x] SVGコンポーネントとして実装（`/src/components/layout/Sidebar/SidebarLogo.tsx`）
- [x] ホームへのリンク機能を実装
- [x] Figma仕様に準拠（67.51×20px, #151834）

### 5. アイコンシステムの構築
- [x] アイコンシステムファイルの作成（`/src/components/layout/Sidebar/icons.tsx`）
- [x] lucide-reactを使用した統一的なアイコン管理
- [x] 16×16pxのアイコンサイズ定義

### 6. サイドナビゲーションコンポーネントの実装
- [x] ベースコンポーネントの作成（`/src/components/layout/Sidebar/index.tsx`）
- [x] ロゴセクションの実装（`SidebarLogo.tsx`）
- [x] 検索セクションの実装（`SidebarSearch.tsx`）
- [x] メインナビゲーション項目の実装（`SidebarMenuItem.tsx`）
- [x] グループラベルの実装（`SidebarGroupLabel.tsx`）
- [x] メニューグループの実装（`SidebarMenuGroup.tsx`）
- [x] 型定義の作成（`types.ts`）

### 7. レスポンシブ対応の実装
- [x] ブレークポイントの定義（1024px: lg）
- [x] デスクトップ用固定サイドバー実装（240px幅）
- [x] モバイル用ハンバーガーメニュー実装
- [x] Layoutコンポーネントの更新（`/src/components/layout/Layout.tsx`）

### 8. ページルーティングとアクティブ状態の管理
- [x] React Router v6のuseLocationでアクティブ判定
- [x] 各ナビゲーション項目のリンク設定完了
- [x] アクティブ状態の視覚的フィードバック実装（背景色・フォントウェイト変更）

### 9. ログイン/マイページの条件分岐実装
- [x] useAuthフックで認証状態取得
- [x] ログイン/マイページの表示切り替え実装
- [x] 条件に応じたアイコン・テキスト変更

### 10. 検索機能の実装
- [x] 検索UIコンポーネントの作成完了
- [ ] 検索ロジックの実装（TODO: 後で実装）
- [ ] 検索結果の表示方法の決定（TODO: 後で実装）

## 進捗状況
- ✅ ステップ1完了：プロジェクト分析完了
- ✅ ステップ2完了：Figmaデザイン仕様確認完了
- ✅ ステップ3完了：コンポーネント構造設計完了
- ✅ ステップ4完了：BONOロゴコンポーネント実装完了
- ✅ ステップ5完了：アイコンシステム構築完了
- ✅ ステップ6完了：サイドナビゲーションコンポーネント実装完了
- ✅ ステップ7完了：レスポンシブ対応実装完了
- ✅ ステップ8完了：ルーティングとアクティブ状態管理完了
- ✅ ステップ9完了：ログイン/マイページ条件分岐完了
- ⏸️ ステップ10：検索機能UIは完成、ロジックは保留

## 分析結果

### 技術スタック
- **フレームワーク**: React 18.3.1 + TypeScript
- **ルーティング**: React Router v6
- **UI コンポーネント**: shadcn/ui (Radix UI)
- **スタイリング**: Tailwind CSS
- **認証**: Supabase Auth (AuthContext)
- **状態管理**: React Context API

### 現在のナビゲーション構造
- **メインHeader**: `/src/components/layout/Header.tsx`
  - デスクトップ: NavigationMenu (ドロップダウン式)
  - モバイル: Sheet + ハンバーガーメニュー
  - 認証状態によるUI切り替え対応済み

- **TrainingHeader**: `/src/components/training/TrainingHeader.tsx`
  - トレーニングページ専用のヘッダー
  - BONOロゴ使用

### 主要なページ構造
- Layoutコンポーネントがヘッダーとフッターを包含
- 各ページがLayoutコンポーネントを使用
- ルーティングは`App.tsx`で一元管理

## 実装成果物

### 作成されたファイル
```
src/components/layout/Sidebar/
├── index.tsx              # メインSidebarコンポーネント
├── SidebarLogo.tsx        # BONOロゴコンポーネント
├── SidebarSearch.tsx      # 検索ボックスコンポーネント
├── SidebarMenuGroup.tsx   # メニューグループコンポーネント
├── SidebarGroupLabel.tsx  # グループラベルコンポーネント
├── SidebarMenuItem.tsx    # メニュー項目コンポーネント
├── icons.tsx              # アイコンマッピングとヘルパー
└── types.ts               # TypeScript型定義
```

### 更新されたファイル
- `src/components/layout/Layout.tsx` - Sidebar統合、レスポンシブ対応

### 主要な機能
- ✅ Figma仕様に準拠したデザイン実装
- ✅ デスクトップ用固定サイドバー（240px）
- ✅ モバイル用ハンバーガーメニュー
- ✅ アクティブページのハイライト表示
- ✅ 認証状態に応じたメニュー切り替え
- ✅ アクセシビリティ対応（ARIA属性、キーボード操作）

## チェック項目（ステップ別）

### ステップ2: Figmaデザイン仕様確認
- [x] Figma仕様書（`figma-specs/`）の内容を確認
- [x] カラーパレットを記録（#ffffff, #f5f5f5, #f9fafb等）
- [x] フォント仕様を確認（Inter, 12px/14px, 400/500）
- [x] スペーシング仕様を確認（240px幅, 32px高, 8px padding等）

### ステップ3: コンポーネント構造設計
- [x] コンポーネント分割が適切か確認
- [x] 型定義が完全か確認（`types.ts`）
- [x] 再利用性を考慮した設計になっているか

### ステップ4: BONOロゴ実装
- [x] SVGパスが正確にコピーされているか
- [x] サイズが正しいか（67.51×20px）
- [x] カラーが正しいか（#151834）
- [x] ホームリンク（"/"）が機能するか

### ステップ5: アイコンシステム
- [x] lucide-reactがインストール済みか確認
- [x] すべての必要なアイコンがマッピングされているか
- [x] アイコンサイズが統一されているか（16px）
- [x] `getIcon`ヘルパー関数が正しく動作するか

### ステップ6: コンポーネント実装
- [x] **SidebarLogo**: ロゴが表示され、クリックでホームに遷移するか
- [x] **SidebarSearch**: 入力フィールドが機能するか、スタイルが正しいか
- [x] **SidebarGroupLabel**: フォントサイズ（12px）とカラー（rgba(10,10,10,0.7)）が正しいか
- [x] **SidebarMenuItem**:
  - 通常状態のスタイルが正しいか（背景透明、#0a0a0a）
  - アクティブ状態のスタイルが正しいか（背景#f5f5f5、font-weight: 500）
  - ホバー時の背景色が正しいか（#f9fafb）
- [x] **SidebarMenuGroup**: グループラベルとメニュー項目が正しく配置されているか
- [x] **Sidebar**: すべてのセクションが正しく表示されているか

### ステップ7: レスポンシブ対応
- [ ] **デスクトップ（1024px以上）**:
  - [ ] サイドバーが左に固定表示されているか
  - [ ] 幅が240pxで固定されているか
  - [ ] メインコンテンツが左マージン（240px）を持っているか
- [ ] **タブレット/モバイル（1024px未満）**:
  - [ ] ハンバーガーメニューボタンが表示されるか
  - [ ] ボタンクリックでサイドバーが開くか
  - [ ] オーバーレイが表示されるか
  - [ ] 外側クリックまたはEscキーでサイドバーが閉じるか

### ステップ8: ルーティングとアクティブ状態
- [ ] 各メニュー項目をクリックして正しいページに遷移するか:
  - [ ] ロードマップ → `/roadmap`
  - [ ] レッスン → `/courses`
  - [ ] ガイド → `/guide`
  - [ ] 設定 → `/settings`
  - [ ] マイページ/ログイン → `/profile` or `/auth`
- [ ] 現在のページに対応するメニュー項目がハイライトされているか
- [ ] アクティブ状態の視覚的フィードバックが正しいか（背景色・フォント）

### ステップ9: ログイン/マイページ条件分岐
- [ ] **ログアウト状態**:
  - [ ] 「ログイン」テキストが表示されるか
  - [ ] LogInアイコンが表示されるか
  - [ ] クリックで`/auth`に遷移するか
- [ ] **ログイン状態**:
  - [ ] 「マイページ」テキストが表示されるか
  - [ ] Userアイコンが表示されるか
  - [ ] クリックで`/profile`に遷移するか

### ステップ10: 検索機能
- [x] 検索ボックスが表示されているか
- [x] プレースホルダー「検索」が表示されているか
- [x] 検索アイコンが正しく表示されているか
- [ ] 入力時にonSearchコールバックが呼ばれるか（開発者ツールで確認）
- [ ] （将来）検索結果が表示されるか

## 動作確認手順

### 1. 開発サーバー起動
```bash
npm run dev
```

### 2. ビジュアル確認
- [ ] サイドバーが左側に表示されているか
- [ ] BONOロゴが正しく表示されているか
- [ ] 検索ボックスが正しいスタイルか
- [ ] メニュー項目がすべて表示されているか
- [ ] スペーシングが適切か（Figma仕様と比較）

### 3. インタラクション確認
- [ ] メニュー項目にホバーすると背景色が変わるか
- [ ] メニュー項目クリックでページ遷移するか
- [ ] アクティブ状態が正しく表示されるか
- [ ] ログイン/ログアウトでメニューが切り替わるか

### 4. レスポンシブ確認
- [ ] ブラウザ幅を1024px以下にする
- [ ] ハンバーガーメニューが表示されるか
- [ ] クリックでサイドバーが開くか
- [ ] モバイルでタップしやすいサイズか

### 5. アクセシビリティ確認
- [ ] Tabキーでメニュー項目にフォーカスできるか
- [ ] Enterキーでリンクを開けるか
- [ ] フォーカス表示が明確か
- [ ] スクリーンリーダーで読み上げられるか（任意）

## 既知の問題・今後のタスク

### 検索機能
- UIは完成
- 検索ロジックの実装が必要
- 検索結果の表示方法を決定する必要あり

### ページルート
一部のルートがまだ作成されていない可能性：
- `/roadmap` - 作成済みか確認
- `/guide` - 作成が必要かもしれない
- `/settings` - 作成が必要かもしれない

### パフォーマンス最適化
- コードスプリッティング（ビルド警告参照）
- アイコンの遅延読み込み（必要に応じて）

### アニメーション
- ページ遷移アニメーション（Figma仕様に記載なし、必要に応じて）
- サイドバー開閉アニメーションの微調整
