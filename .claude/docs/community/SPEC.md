# コミュニティ機能 仕様書

**最終更新**: 2026-02-18

---

## 機能一覧

### Phase 1: 優先実装

| 機能 | 説明 | アクセス制限 |
|------|------|-------------|
| 質問一覧 | コミュニティの質問を一覧表示 | 全員 |
| 質問詳細 | 質問の詳細とコメント | 全員 |
| フィードバック一覧 | デザインフィードバックを一覧表示 | 全員 |
| フィードバック詳細 | フィードバックの詳細内容 | **フィードバックプランのみ** |
| ナレッジ一覧 | ナレッジ記事を一覧表示 | 全員 |
| ナレッジ詳細 | ナレッジ記事の詳細 | TBD |

### Phase 2: 次の優先度

| 機能 | 説明 |
|------|------|
| ブログ（ナビ追加） | 既存のブログをナビゲーションに設置 |
| イベント一覧 | イベント詳細ページ（既存仕組み活用） |

---

## ナビゲーション設計

### 検討事項
- 「質問」「フィードバック」「ナレッジ」をどう配置するか
- 既存のナビゲーション（レッスン、記事等）との整合性

### 案（TBD）
```
[既存]
- ホーム
- レッスン
- 記事

[新規追加]
- コミュニティ
  - 質問
  - フィードバック
  - ナレッジ
- ブログ
- イベント
```

---

## ページ仕様

### 質問一覧 `/questions`

**表示項目**:
- タイトル
- 投稿者
- 投稿日
- コメント数
- タグ/カテゴリ

**機能**:
- 検索
- フィルター（カテゴリ、日付）
- ページネーション

---

### 質問詳細 `/questions/:id`

**表示項目**:
- タイトル
- 本文
- 投稿者
- 投稿日
- コメント一覧

**機能**:
- コメント投稿（ログインユーザー）

---

### フィードバック一覧 `/feedback`

**表示項目**:
- タイトル/概要
- 投稿者
- 投稿日
- サムネイル（デザイン画像）

**機能**:
- 検索
- フィルター

---

### フィードバック詳細 `/feedback/:id`

**アクセス制限**: フィードバックプランのみ

**表示項目**:
- デザイン画像
- フィードバック内容
- やり取り履歴

---

### ナレッジ一覧 `/knowledge`

**表示項目**:
- タイトル
- 概要
- カテゴリ
- 投稿日

---

### ナレッジ詳細 `/knowledge/:slug`

**表示項目**:
- タイトル
- 本文（リッチテキスト）
- 関連ナレッジ

---

## データ設計（Sanity Schema）

### 質問 `question`
```typescript
{
  _type: 'question',
  title: string,
  body: PortableText,
  author: reference<user>,
  tags: string[],
  createdAt: datetime,
  comments: reference<comment>[]
}
```

### フィードバック `feedback`
```typescript
{
  _type: 'feedback',
  title: string,
  description: text,
  images: image[],
  author: reference<user>,
  feedbackContent: PortableText,
  createdAt: datetime,
  isPremium: boolean // フィードバックプラン限定
}
```

### ナレッジ `knowledge`
```typescript
{
  _type: 'knowledge',
  title: string,
  slug: slug,
  excerpt: text,
  content: PortableText,
  category: string,
  tags: string[],
  publishedAt: datetime
}
```

---

## アクセス制御

| ページ | 未ログイン | 無料会員 | スタンダード | フィードバック |
|--------|-----------|---------|-------------|---------------|
| 質問一覧 | ✅ | ✅ | ✅ | ✅ |
| 質問詳細 | ✅ | ✅ | ✅ | ✅ |
| フィードバック一覧 | ✅ | ✅ | ✅ | ✅ |
| フィードバック詳細 | ❌ | ❌ | ❌ | ✅ |
| ナレッジ一覧 | ✅ | ✅ | ✅ | ✅ |
| ナレッジ詳細 | TBD | TBD | TBD | TBD |

---

## デザイン

### 方針
- まずはAIと一緒に実装してイメージプロトタイプを作成
- ベータ版のデザインを整える

### 参考
- 既存のブログページ
- レッスン一覧ページ
