# 記事本文の書式設計

**作成日**: 2025-12-11
**ステータス**: 決定済み

---

## タイポグラフィ比較表：現在 vs VitePress

### 見出しスタイル

| 要素   | 現在（BONO）            | VitePress                    | 差分        |
| ------ | ----------------------- | ---------------------------- | ----------- |
| **H1** | ❌ 未対応               | 28px→32px / lh:40px / fw:600 | 未実装      |
| **H2** | 20px / lh:32px / fw:700 | 24px / lh:32px / fw:600      | サイズ -4px |
| **H3** | 16px / lh:28px / fw:600 | 20px / lh:28px / fw:600      | サイズ -4px |
| **H4** | 15px / lh:24px / fw:600 | 18px / lh:24px / fw:600      | サイズ -3px |
| **H5** | ❌ 未対応               | 16px / lh:24px / fw:600      | 未実装      |
| **H6** | ❌ 未対応               | 14px / lh:24px / fw:600      | 未実装      |

#### コメント

- H1 は必要ないです
- H2 は vitePress のものに合わせたい
- H3 も Vitepress
- H4 も Vitepress

### 本文スタイル

| 要素                  | 現在（BONO）                               | VitePress                     | 差分        |
| --------------------- | ------------------------------------------ | ----------------------------- | ----------- |
| **段落 (p)**          | 16px / lh:26px / #364153                   | 16px / lh:28px                | lh -2px     |
| **引用 (blockquote)** | 16px / lh:26px / border-l:4px / bg:#F9FAFB | 16px / lh:28px / border-l:2px | border 太め |
| **リストアイテム**    | 16px / lh:26px / pl:21.5px                 | 16px / lh:28px                | 同等        |

#### コメント

- テキストサイズは 18px,lh は 200％にしたいです。

### インライン装飾

| 要素           | 現在（BONO）           | VitePress         | 差分   |
| -------------- | ---------------------- | ----------------- | ------ |
| **太字**       | ✅ fw:700              | ✅ fw:600         | 太め   |
| **斜体**       | ✅ italic              | ✅ italic         | 同等   |
| **コード**     | ✅ bg:#F3F4F6 / mono   | ✅ bg:soft / mono | 同等   |
| **リンク**     | ✅ #2563EB / underline | ✅ brand color    | 同等   |
| **打ち消し線** | ❌ 未対応              | ✅ 対応           | 未実装 |
| **ハイライト** | ❌ 未対応              | ✅ 対応           | 未実装 |

### フォント設定

| 項目               | 現在（BONO）   | VitePress               |
| ------------------ | -------------- | ----------------------- |
| **本文フォント**   | Inter          | Inter                   |
| **見出しフォント** | Inter          | Inter                   |
| **コードフォント** | system mono    | Menlo, Monaco, Consolas |
| **letter-spacing** | -1.95% ~ 0.35% | -0.02em                 |

#### コメント

- フォントはサービスのデザインシステムでデフォルトになっているフォントを当ててほしいです
- おそらく本文まわりのものには noto sans jp, 見出しやタイトルは hiragino maru goshic が当たっているような気がします。確認して変更したいです。
- letter-spacing は 3%を当ててほしいです。

---

## 機能比較表：現在 vs VitePress

### 見出し

| 項目     | 現在（Sanity） | VitePress  | ギャップ |
| -------- | -------------- | ---------- | -------- |
| H1       | ❌ 0           | ✅ 1       | -1       |
| H2       | ✅ 1           | ✅ 1       | 0        |
| H3       | ✅ 1           | ✅ 1       | 0        |
| H4       | ✅ 1           | ✅ 1       | 0        |
| H5       | ❌ 0           | ✅ 1       | -1       |
| H6       | ❌ 0           | ✅ 1       | -1       |
| **合計** | **3 種類**     | **6 種類** | **-3**   |

#### コメント

- 一応 H4 までほしいです。値は Vitepress を真似してほしいです

### インライン装飾

| 項目              | 現在（Sanity） | VitePress  | ギャップ |
| ----------------- | -------------- | ---------- | -------- |
| 太字              | ✅ 1           | ✅ 1       | 0        |
| 斜体              | ✅ 1           | ✅ 1       | 0        |
| インラインコード  | ✅ 1           | ✅ 1       | 0        |
| 下線              | ❌ 0           | ✅ 1       | -1       |
| 打ち消し線        | ❌ 0           | ✅ 1       | -1       |
| ハイライト/マーク | ❌ 0           | ✅ 1       | -1       |
| **合計**          | **3 種類**     | **6 種類** | **-3**   |

### ブロック要素

| 項目           | 現在（Sanity）  | VitePress  | ギャップ |
| -------------- | --------------- | ---------- | -------- |
| 段落           | ✅ 1            | ✅ 1       | 0        |
| 引用           | ✅ 1            | ✅ 1       | 0        |
| 箇条書きリスト | ✅ 1 (実装済み) | ✅ 1       | 0        |
| 番号付きリスト | ✅ 1 (実装済み) | ✅ 1       | 0        |
| **合計**       | **4 種類**      | **4 種類** | **0**    |

### 埋め込み・特殊ブロック

| 項目                                               | 現在（Sanity） | VitePress           | ギャップ           |
| -------------------------------------------------- | -------------- | ------------------- | ------------------ |
| 画像                                               | ✅ 1           | ✅ 1                | 0                  |
| テーブル                                           | ❌ 0           | ✅ 1                | -1                 |
| コードブロック                                     | ❌ 0           | ✅ 1                | -1                 |
| シンタックスハイライト言語数                       | 0              | **100+**            | -100+              |
| カスタムコンテナ (info/tip/warning/danger/details) | ❌ 0           | ✅ **5 種類**       | -5                 |
| GitHub Alerts (NOTE/TIP/IMPORTANT/WARNING/CAUTION) | ❌ 0           | ✅ **5 種類**       | -5                 |
| 動画埋め込み                                       | ❌ 0           | ❌ 0                | 0                  |
| **合計**                                           | **1 種類**     | **8 種類+100 言語** | **大きなギャップ** |

### リンク

| 項目                 | 現在（Sanity） | VitePress        | ギャップ |
| -------------------- | -------------- | ---------------- | -------- |
| 外部リンク           | ✅ 1           | ✅ 1             | 0        |
| 内部リンク（記事間） | ❌ 0           | ✅ 1（自動処理） | -1       |
| アンカーリンク       | ❌ 0           | ✅ 1（自動生成） | -1       |
| **合計**             | **1 種類**     | **3 種類**       | **-2**   |

#### コメント

- リンクを本文に挿入するときに「OGP などを出す引用的に表示すること」は可能でしょうか？？

### その他の機能

| 項目           | 現在（Sanity） | VitePress        | ギャップ |
| -------------- | -------------- | ---------------- | -------- |
| 目次自動生成   | ❌             | ✅               | -1       |
| 絵文字サポート | ❌             | ✅               | -1       |
| 数式 (LaTeX)   | ❌             | ✅（オプション） | -1       |
| Frontmatter    | ❌             | ✅               | -1       |

#### コメント

- 質問：このリッチテキストにおける Frontmatter とは何をするものでしょうか
- 目次はほしいです。可能なら適切なタイミングで挿入する位置を調整できるととても嬉しいですが可能ですか？実装タスクに追加して。スタイルも追加できるなら弄る必要があります。
- ***

## 総合スコア

| カテゴリ       | 現在   | VitePress | カバー率    |
| -------------- | ------ | --------- | ----------- |
| 見出し         | 3      | 6         | **50%**     |
| インライン装飾 | 3      | 6         | **50%**     |
| ブロック要素   | 4      | 4         | **100%** ✅ |
| 埋め込み・特殊 | 1      | 8+        | **12%**     |
| リンク         | 1      | 3         | **33%**     |
| **総合**       | **12** | **27+**   | **〜44%**   |

---

## 相談・検討事項

### Q1: ✅ コードブロックは必要？

**背景**: 技術ドキュメントやチュートリアルでコードを書く場合

**VitePress の機能**:

- 100+言語のシンタックスハイライト（[Shiki](https://shiki.style/languages)使用）
- 行番号表示
- 行ハイライト
- diff 表示
- コードブロックスタイル: font-size: 0.875em / line-height: 1.7

**選択肢**:

- A) Sanity にコードブロック追加（シンタックスハイライト付き）
- B) 現状維持（インラインコードのみ）
- C) Markdown で直接保存してフロントで変換

**回答**: ❌ **コードブロックは必要ない**

---

### Q2: ✅ カスタムコンテナ（Info/Warning/Tip）は必要？

**背景**: 教育コンテンツで「注意点」「ポイント」などを目立たせたい場合

**VitePress の機能**:

- 5 種類: `info`, `tip`, `warning`, `danger`, `details`
- GitHub Alerts: 5 種類 (`NOTE`, `TIP`, `IMPORTANT`, `WARNING`, `CAUTION`)

**例**:

```
::: tip ポイント
ここが重要なポイントです
:::

::: warning 注意
この操作は取り消せません
:::
```

**選択肢**:

- A) Sanity にカスタムブロックとして追加
- B) 不要（引用ブロックで代用）
- C) Markdown で直接保存

**回答**: ✅ **必要。Notion のようなスタイルのものが欲しい**

---

### Q3: ✅ テーブルは必要？

**背景**: 比較表や仕様一覧を書きたい場合

**VitePress の機能**:

- GitHub 風テーブル構文サポート

**選択肢**:

- A) Sanity にテーブルブロック追加
- B) 画像で代用
- C) 不要

**回答**: ✅ **テーブルは必要。VitePress のスタイルを真似する**

---

### Q4: ✅ リストは必要？

**現状**: 箇条書き・番号付きリストが**実装済み**（RichTextSection.tsx）

**VitePress の機能**:

- 箇条書きリスト (`- item`)
- 番号付きリスト (`1. item`)
- ネストリスト

**選択肢**:

- A) Sanity に追加（実装難易度: 低）
- B) 不要

**回答**: ✅ **すごく必要。箇条書きも番号付きも必須。スタイル指定用ファイルを作成**

→ **スタイル指定ファイル**: `./style-spec-list.md`

---

### Q5: Markdown 直接保存 vs Portable Text

**現状**: Portable Text（Sanity のリッチテキスト形式）で保存

**スコア比較**:
| 方式 | カバー率 | 編集しやすさ | Sanity 機能 |
|------|---------|-------------|-----------|
| 現在（Portable Text） | 44% | 中 | フル活用 |
| Markdown 直接保存 | 90%+ | 高 | 限定的 |

**選択肢**:

- A) 現状維持（Portable Text + Markdown Import）
- B) Markdown 直接保存に変更
- C) 両方対応（フィールド 2 つ）

**回答**: （未回答）

---

## 決定事項

| 項目             | 決定内容                                    | 決定日     |
| ---------------- | ------------------------------------------- | ---------- |
| コードブロック   | ❌ 不要                                     | 2025-12-11 |
| カスタムコンテナ | ✅ 実装する（Notion 風）                    | 2025-12-11 |
| テーブル         | ✅ 実装する（VitePress 風）                 | 2025-12-11 |
| リスト           | ✅ スタイル調整（スタイル指定ファイル参照） | 2025-12-11 |
| 見出し（H2-H4）  | ✅ VitePress のスタイルに合わせる           | 2025-12-11 |
| レスポンシブ     | ✅ 全要素 -2px（note.com 準拠）             | 2025-12-11 |

---

## レスポンシブルール（note.com 準拠）

**基本ルール**: デスクトップ → モバイル で **全要素 -2px**

### フォントサイズ対応表

| 要素 | デスクトップ (≥768px) | モバイル (<768px) | 差分 |
|------|----------------------|-------------------|------|
| H2   | 24px                 | 22px              | -2px |
| H3   | 20px                 | 18px              | -2px |
| H4   | 18px                 | 16px              | -2px |
| 本文 | 18px                 | 16px              | -2px |
| リスト | 18px               | 16px              | -2px |

### 実装方針

```css
/* モバイルファースト */
p, li { font-size: 16px; }
h2 { font-size: 22px; }
h3 { font-size: 18px; }
h4 { font-size: 16px; }

@media (min-width: 768px) {
  p, li { font-size: 18px; }
  h2 { font-size: 24px; }
  h3 { font-size: 20px; }
  h4 { font-size: 18px; }
}
```

### 参考
- **note.com**: 本文 18px(desktop) → 16px(mobile)
- **VitePress**: H1のみレスポンシブ対応（その他は固定）

---

## 実装タスク

### スタイル調整（既存要素）

| #   | タスク                       | 優先度 | ステータス | 備考                                                 |
| --- | ---------------------------- | ------ | ---------- | ---------------------------------------------------- |
| 1   | 見出しスタイル調整（H2-H4）  | 高     | 待機中     | VitePress準拠 [style-spec-heading.md](./style-spec-heading.md) |
| 2   | **余白（margin）調整**       | 高     | 待機中     | VitePress準拠（下記参照）                            |
| 3   | 本文スタイル調整             | 高     | 待機中     | 18px / lh:200% / letter-spacing:3%                   |
| 4   | フォント確認・変更           | 高     | 待機中     | 本文:Noto Sans JP / 見出し:Hiragino Maru Gothic 確認 |
| 5   | 箇条書きリストのスタイル調整 | 高     | 待機中     | [style-spec-list.md](./style-spec-list.md)           |
| 6   | 番号付きリストのスタイル調整 | 高     | 待機中     | [style-spec-list.md](./style-spec-list.md)           |

### 余白（margin）仕様（VitePress + 読みやすさ調整）

| 要素 | VitePress | 採用値 | 備考 |
|------|-----------|--------|------|
| **H2** | `48px 0 16px` | `48px 0 24px` | 下を広げて読みやすく |
| **H3** | `32px 0 0` | `32px 0 16px` | 下余白を追加 |
| **H4** | `24px 0 0` | `24px 0 12px` | 下余白を追加 |
| **p（段落）** | `16px 0` | `24px 0` | lh:200%に合わせて広く |
| **ul, ol（リスト）** | `16px 0` | `24px 0` | 段落と統一 |
| **li + li** | `8px` | `8px` | VitePress準拠 |
| **blockquote** | `16px 0` | `24px 0` | 段落と統一 |
| **table** | `20px 0` | `24px 0` | 段落と統一 |

### 新機能実装

| #   | タスク                       | 優先度 | ステータス | 備考                                                 |
| --- | ---------------------------- | ------ | ---------- | ---------------------------------------------------- |
| 7   | カスタムコンテナ実装         | 高     | 待機中     | Notion風 [style-spec-container.md](./style-spec-container.md) |
| 8   | テーブル実装                 | 中     | 待機中     | VitePress風 [style-spec-table.md](./style-spec-table.md) |
| 9   | 目次自動生成                 | 中     | 待機中     | 挿入位置調整も検討                                   |
| 10  | リンクカード（OGPプレビュー）| 中     | 要検討     | 技術調査必要                                         |

### 質問への回答

| 質問 | 回答 |
|------|------|
| **Frontmatterとは？** | Markdownファイルの先頭にYAML形式でメタデータ（タイトル、日付、タグ等）を記述する機能。Sanityでは不要（スキーマで管理）|
| **目次の挿入位置調整は可能か？** | ✅ 可能。見出しタグ（H2-H4）を解析して目次を生成し、表示位置はコンポーネントで制御できる |
| **OGPリンクカードは可能か？** | ✅ 可能だが実装工数あり。Sanityにカスタムブロック追加 + フロントでOGP取得が必要 |

---

## 参考リンク

- [VitePress Markdown Extensions](https://vitepress.dev/guide/markdown)
- [VitePress vp-doc.css (GitHub)](https://github.com/vuejs/vitepress/blob/main/src/client/theme-default/styles/components/vp-doc.css) - タイポグラフィ値
- [Shiki Languages](https://shiki.style/languages) - 100+言語対応
- [GitHub - Shiki](https://github.com/shikijs/shiki)
- [Sanity Portable Text](https://www.sanity.io/docs/portable-text)

---

## 現在の実装詳細

**ファイル**: `src/components/article/RichTextSection.tsx`

```typescript
// 現在のスタイル定義（抜粋）
h2: 20px / bold / lh:32px / #101828 / mt:48px / mb:24px
h3: 16px / semibold / lh:28px / #101828 / mt:32px / mb:16px
h4: 15px / semibold / lh:24px / #101828 / mt:24px / mb:12px
p:  16px / regular / lh:26px / #364153 / mb:16px
blockquote: 16px / lh:26px / border-l:4px #D0D5DD / bg:#F9FAFB
code: bg:#F3F4F6 / px:6px / py:2px / rounded / mono
link: #2563EB / underline / hover:#1D4ED8

// リスト（既存）
bullet-list: list-disc / pl:21.5px / mb:16px / space-y:8px
number-list: list-decimal / pl:21.5px / mb:16px / space-y:8px
list-item: 16px / lh:26px / #364153
```
