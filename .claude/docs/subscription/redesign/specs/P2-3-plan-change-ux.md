# P2-3: プラン変更 UI 体験のブラッシュアップ - 仕様書

**作成日**: 2025-12-01
**ステータス**: 仕様策定中
**担当**: ユーザー（仕様作成）→ Claude（実装）

---

## 現状の問題

プラン変更時の UI 体験が不十分：

1. ボタンを押しても何をしているのかトースト以外でユーザーにはわからない
2. 処理中の状態が視覚的に不明確
3. 全てトーストで完結している

---

## 改善が必要な画面・フロー

### 対象画面

- `/subscription` - サブスクリプションプラン選択画面

### 対象フロー

1. プラン変更ボタンクリック
2. 確認モーダル表示
3. 「プラン変更を確定」ボタンクリック
4. 処理中...
5. 完了

---

## 体験仕様書

1. 更新するボタンをユーザーが押す
2. 確認のモーダルが出る
   1. 金額の計算と更新するの確認ボタンがあり、
   2. 更新するボタンが表示される
3. モーダルで更新するボタンを押す
4. モーダル上で処理中の表示を表示
   1. 成功
      1. XXX プランへの更新処理をしています
      2. ローダーも表示する
   2. エラーの場合
      1. エラー内容を表示する
      2. モーダルを閉じるボタン
5. 処理が成功
   1. 更新サクセスページへ遷移
      1. 内容やデザインとしては「新規登録成功後の作成ページと全く一緒」
      2. 文言で「XXX プランへの更新が完了しました」が表示される
   2. エラーの場合
      1. 遷移しない
      2. モーダル上でエラーメッセージ

## 仕様を決める項目

### 1. 処理中の表示

**現状**:

- ボタンが「処理中...」になる
- トースト「プラン変更を受け付けました」が表示

**検討項目**:

- [ ] ローディングオーバーレイを追加するか？
- [ ] ボタンの見た目をどう変えるか？
- [ ] プログレスインジケーターを追加するか？

**希望する動作**:

```
（ここに記入してください）
```

---

### 2. 完了時の表示

**現状**:

- トースト「プラン変更が完了しました」が表示
- 画面が自動更新される

**検討項目**:

- [ ] 完了モーダルを表示するか？
- [ ] 成功アニメーションを追加するか？
- [ ] 完了後の遷移先は？（そのまま/別ページ）

**希望する動作**:

```
（ここに記入してください）
```

---

### 3. 確認モーダルの改善

**現状**:

- プラン変更前後の情報を表示
- 「プラン変更を確定」「キャンセル」ボタン

**検討項目**:

- [ ] 追加で表示したい情報はあるか？
- [ ] ボタンの文言を変更するか？
- [ ] 警告メッセージを追加するか？

**希望する動作**:

```
（ここに記入してください）
```

---

### 4. エラー時の表示

**現状**:

- トースト（赤）でエラーメッセージ表示

**検討項目**:

- [ ] エラーモーダルを表示するか？
- [ ] リトライボタンを追加するか？
- [ ] サポート連絡先を表示するか？

**希望する動作**:

```
（ここに記入してください）
```

---

## 参考: 現在の UI 要素

### 使用中のコンポーネント

- `PlanCard` - プランカード
- `PlanChangeConfirmModal` - 確認モーダル
- `useToast` - トースト通知

### 関連ファイル

- `src/pages/Subscription.tsx`
- `src/components/subscription/PlanChangeConfirmModal.tsx`
- `src/components/subscription/PlanCard.tsx`

---

## 記入例

### 例: 処理中の表示

```
希望する動作:
- 確認モーダルを閉じずに、モーダル内でローディング表示
- ボタンを無効化してスピナー表示
- 「処理中です...」のテキストをモーダル内に表示
```

---

## 次のステップ

1. このドキュメントの「希望する動作」セクションを記入
2. Claude に共有
3. 実装開始

---

**備考**:

- デザインの参考画像があれば共有してください
- 優先度が高い項目から実装します
