# 本番環境サブスクリプション検証

**作成日**: 2025-12-02 JST
**ステータス**: 検証準備中

---

## 目的

mainブランチにマージされたサブスクリプション実装が本番環境で正常に動作することを確認する。

---

## 検証項目

### Phase A: 課金なしの確認

| # | 確認項目 | 手順 | 期待結果 | 結果 |
|---|---------|------|---------|------|
| A-1 | ログイン | 本番サイトに既存アカウントでログイン | ログイン成功 | ⏳ |
| A-2 | /subscription 表示 | `/subscription` ページにアクセス | 料金プラン（Standard/Feedback）が表示される | ⏳ |
| A-3 | /account 表示 | `/account` ページにアクセス | 現在のステータスが表示される | ⏳ |

### Phase B: 課金テスト（オプション）

| # | 確認項目 | 手順 | 期待結果 | 結果 |
|---|---------|------|---------|------|
| B-1 | 新規登録 | Standard 1M (¥6,800) を購入 | Checkout完了 → 成功ページ | ⏳ |
| B-2 | DB反映 | `/account` を確認 | プランが反映されている | ⏳ |
| B-3 | Webhook処理 | Stripe Dashboard → Webhooksログ | 200 OK | ⏳ |
| B-4 | キャンセル | カスタマーポータルからキャンセル | キャンセル成功、DB反映 | ⏳ |

---

## 前提条件

- [x] Phase 5 本番デプロイ完了
- [x] ENV-001, ENV-002, ENV-003 全て解決済み
- [x] Webhook 200 OK 確認済み

---

## テスト環境

| 項目 | 値 |
|------|-----|
| URL | https://bono-training.vercel.app |
| Supabase | fryogvfhymnpiqwssmuu（本番） |
| Stripe | Live モード |

---

## 検証手順

### Phase A: 課金なしの確認

#### A-1: ログイン

1. https://bono-training.vercel.app にアクセス
2. 既存アカウントでログイン
3. ログイン成功を確認

**結果**:

---

#### A-2: /subscription 表示

1. `/subscription` にアクセス
2. 確認項目:
   - [ ] ページが正常に表示される（白画面ではない）
   - [ ] Standard プラン（¥6,800 / ¥17,400）が表示
   - [ ] Feedback プラン（¥15,800 / ¥42,000）が表示
   - [ ] 「選択する」ボタンが機能する

**結果**:

---

#### A-3: /account 表示

1. `/account` にアクセス
2. 確認項目:
   - [ ] ページが正常に表示される
   - [ ] 現在のプラン状態が表示される
   - [ ] サブスク管理ボタンが表示される（該当する場合）

**結果**:

---

### Phase B: 課金テスト（オプション）

#### B-1: 新規登録

1. `/subscription` にアクセス
2. Standard 1M（¥6,800）を選択
3. Stripe Checkout で支払い
   - カード情報を入力
4. 成功ページに遷移することを確認

**結果**:

---

#### B-2: DB反映確認

1. `/account` にアクセス
2. 確認項目:
   - [ ] プラン: Standard
   - [ ] 期間: 1ヶ月
   - [ ] ステータス: アクティブ

**結果**:

---

#### B-3: Webhook処理確認

1. Stripe Dashboard → Developers → Webhooks
2. 本番Endpoint のログを確認
3. `checkout.session.completed` が 200 OK であること

**結果**:

---

#### B-4: キャンセルテスト

1. `/account` → サブスク管理（カスタマーポータル）
2. 「プランをキャンセル」を選択
3. 確認項目:
   - [ ] キャンセル処理が完了
   - [ ] `/account` に「キャンセル済み」と表示
   - [ ] 期間終了日まで利用可能

**結果**:

---

## 検証結果サマリー

| Phase | 結果 | 備考 |
|-------|------|------|
| Phase A | ⏳ | - |
| Phase B | ⏳ | オプション |

---

## 問題が発生した場合

1. スクリーンショットを撮影
2. コンソールエラーを記録
3. このドキュメントに追記

---

**更新**: 2025-12-02 JST
