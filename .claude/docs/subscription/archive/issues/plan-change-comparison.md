# ãƒ—ãƒ©ãƒ³å¤‰æ›´å®Ÿè£…æ–¹å¼ã®æ¯”è¼ƒåˆ†æ

**ä½œæˆæ—¥**: 2025-11-28

---

## ğŸ¯ æ¯”è¼ƒå¯¾è±¡

### Option 1: Deep Linkï¼ˆCustomer Portalï¼‰
### Option 2: Option 3 + ç‹¬è‡ªUIç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆæ¨å¥¨ï¼‰

---

## ğŸ“Š ãƒã‚°ç™ºç”Ÿç¢ºç‡ã®æ¯”è¼ƒ

### Option 1: Deep Link

#### ãƒã‚°ç™ºç”Ÿãƒã‚¤ãƒ³ãƒˆ

| ãƒã‚°ã®ç¨®é¡ | ç™ºç”Ÿç¢ºç‡ | æ·±åˆ»åº¦ | æ¤œå‡ºé›£æ˜“åº¦ |
|-----------|---------|--------|-----------|
| **äºŒé‡èª²é‡‘** | âš ï¸ ä¸­ï¼ˆ10-20%ï¼‰ | ğŸš¨ Critical | ğŸ”´ é«˜ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å ±å‘Šã¾ã§æ°—ã¥ã‹ãªã„ï¼‰ |
| **Webhookå®Ÿè£…ãƒŸã‚¹** | âš ï¸ ä¸­ï¼ˆ15-25%ï¼‰ | ğŸš¨ Critical | ğŸŸ¡ ä¸­ï¼ˆãƒ­ã‚°ç¢ºèªã§ç™ºè¦‹ï¼‰ |
| **ç’°å¢ƒå¤‰æ•°ãƒŸã‚¹** | âš ï¸ ä½ï¼ˆ5-10%ï¼‰ | ğŸš¨ Critical | ğŸŸ¡ ä¸­ï¼ˆãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ï¼‰ |
| **Stripeä»•æ§˜å¤‰æ›´** | âš ï¸ ä½ï¼ˆ5%ï¼‰ | ğŸš¨ Critical | ğŸ”´ é«˜ï¼ˆäºˆæ¸¬ä¸å¯ï¼‰ |

**åˆè¨ˆãƒã‚°ç™ºç”Ÿç¢ºç‡**: **35-60%**

#### å†ç™ºé˜²æ­¢ç­–ã®å®Ÿç¾æ€§

**å¿…è¦ãªå¯¾ç­–**:
1. âœ… WebhookäºŒé‡èª²é‡‘æ¤œçŸ¥ãƒ»è‡ªå‹•ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ©Ÿèƒ½
2. âœ… å®šæœŸçš„ãªStripe Dashboardæ‰‹å‹•ãƒã‚§ãƒƒã‚¯
3. âš ï¸ ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆäºŒé‡èª²é‡‘æ¤œçŸ¥æ™‚ã«é€šçŸ¥ï¼‰
4. âš ï¸ E2Eãƒ†ã‚¹ãƒˆã®è‡ªå‹•åŒ–ï¼ˆStripeé€£æºå«ã‚€ï¼‰

**å®Ÿç¾æ€§**: ğŸŸ¡ **ä¸­ç¨‹åº¦ï¼ˆ60-70%ï¼‰**

**ç†ç”±**:
- Webhookå®Ÿè£…è‡ªä½“ã¯å¯èƒ½
- ã—ã‹ã—ã€**Stripeå´ã®æŒ™å‹•ã‚’å®Œå…¨ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ããªã„**
- Customer PortalãŒã€Œæ›´æ–°ã€ã§ã¯ãªãã€Œæ–°è¦ä½œæˆã€ã™ã‚‹æ¡ä»¶ãŒä¸æ˜ç¢º
- å°†æ¥çš„ãªStripeä»•æ§˜å¤‰æ›´ãƒªã‚¹ã‚¯ã‚ã‚Š

**ä»Šå›ã®ã‚ˆã†ãªãƒŸã‚¹ã‚’é˜²ãã«ã¯**:
- âŒ **ç¾å®Ÿçš„ã«ã¯å›°é›£**
- Deep Linkä½¿ç”¨æ™‚ã¯ã€ŒäºŒé‡èª²é‡‘ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€ã¨ã„ã†å‰æã§é‹ç”¨
- ç™ºç”Ÿæ™‚ã®è‡ªå‹•ä¿®æ­£ã«é ¼ã‚‹ = **æ”»ã‚ã®é˜²å¾¡**

---

### Option 2: Option 3 + ç‹¬è‡ªUIç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆNEWï¼‰

#### ãƒã‚°ç™ºç”Ÿãƒã‚¤ãƒ³ãƒˆ

| ãƒã‚°ã®ç¨®é¡ | ç™ºç”Ÿç¢ºç‡ | æ·±åˆ»åº¦ | æ¤œå‡ºé›£æ˜“åº¦ |
|-----------|---------|--------|-----------|
| **äºŒé‡èª²é‡‘** | âœ… 0%ï¼ˆæŠ€è¡“çš„ã«ä¸å¯èƒ½ï¼‰ | - | - |
| **UIå®Ÿè£…ãƒŸã‚¹** | âš ï¸ ä¸­ï¼ˆ10-15%ï¼‰ | ğŸŸ¡ Medium | ğŸŸ¢ ä½ï¼ˆç›®è¦–ã§å³ç™ºè¦‹ï¼‰ |
| **ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒŸã‚¹** | âš ï¸ ä½ï¼ˆ5-10%ï¼‰ | ğŸŸ  High | ğŸŸ¡ ä¸­ï¼ˆãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ï¼‰ |
| **ç’°å¢ƒå¤‰æ•°ãƒŸã‚¹** | âš ï¸ ä½ï¼ˆ5-10%ï¼‰ | ğŸš¨ Critical | ğŸŸ¡ ä¸­ï¼ˆãƒ†ã‚¹ãƒˆã§ç™ºè¦‹ï¼‰ |

**åˆè¨ˆãƒã‚°ç™ºç”Ÿç¢ºç‡**: **20-35%**

#### å†ç™ºé˜²æ­¢ç­–ã®å®Ÿç¾æ€§

**å¿…è¦ãªå¯¾ç­–**:
1. âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
2. âœ… ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«UIå®Ÿè£…
3. âœ… Stripeã‹ã‚‰ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æƒ…å ±å–å¾—
4. âœ… æ—¢å­˜ã®Option 3ãƒ­ã‚¸ãƒƒã‚¯æ´»ç”¨ï¼ˆäºŒé‡èª²é‡‘é˜²æ­¢ï¼‰

**å®Ÿç¾æ€§**: âœ… **é«˜ã„ï¼ˆ90%ä»¥ä¸Šï¼‰**

**ç†ç”±**:
- ã™ã¹ã¦è‡ªåˆ†ãŸã¡ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«å¯èƒ½
- Stripeä»•æ§˜å¤‰æ›´ã®å½±éŸ¿ã‚’å—ã‘ã«ãã„
- ãƒã‚°ã¯ç›®è¦–ã§å³ç™ºè¦‹å¯èƒ½

**ä»Šå›ã®ã‚ˆã†ãªãƒŸã‚¹ã‚’é˜²ãã«ã¯**:
- âœ… **ç¾å®Ÿçš„ã«å¯èƒ½**
- UIå®Ÿè£…ãƒŸã‚¹ã¯ç›®è¦–ãƒ†ã‚¹ãƒˆã§å³ç™ºè¦‹
- ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒŸã‚¹ã¯ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ç™ºè¦‹
- **å®ˆã‚Šã®é˜²å¾¡**

---

## ğŸ›¡ï¸ Option 2ã®å®Ÿè£…è©³ç´°

### å®Ÿè£…å†…å®¹

#### 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ä½œæˆ

```typescript
// src/components/subscription/PlanChangeConfirmModal.tsx

interface PlanChangeConfirmModalProps {
  currentPlan: {
    type: PlanType;
    duration: 1 | 3;
    price: number; // æœˆé¡
  };
  newPlan: {
    type: PlanType;
    duration: 1 | 3;
    price: number; // æœˆé¡
  };
  subscriptionInfo: {
    currentPeriodEnd: Date; // æ¬¡å›æ›´æ–°æ—¥
    daysRemaining: number;  // æ®‹ã‚Šæ—¥æ•°
  };
  onConfirm: () => void;
  onCancel: () => void;
}

export const PlanChangeConfirmModal: React.FC<PlanChangeConfirmModalProps> = ({
  currentPlan,
  newPlan,
  subscriptionInfo,
  onConfirm,
  onCancel,
}) => {
  // ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—
  const proration = calculateProration(
    currentPlan,
    newPlan,
    subscriptionInfo.daysRemaining
  );

  return (
    <Dialog open={true}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>ãƒ—ãƒ©ãƒ³å¤‰æ›´ã®ç¢ºèª</DialogTitle>
        </DialogHeader>

        <div className="space-y-4">
          {/* ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³ */}
          <div>
            <p className="text-sm text-gray-600">ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³</p>
            <p className="font-bold">
              {getPlanName(currentPlan.type)} {currentPlan.duration}ãƒ¶æœˆãƒ—ãƒ©ãƒ³
            </p>
            <p className="text-sm">Â¥{currentPlan.price.toLocaleString()}/æœˆ</p>
          </div>

          {/* çŸ¢å° */}
          <div className="flex justify-center">
            <ArrowDown className="h-6 w-6" />
          </div>

          {/* æ–°ã—ã„ãƒ—ãƒ©ãƒ³ */}
          <div>
            <p className="text-sm text-gray-600">å¤‰æ›´å¾Œã®ãƒ—ãƒ©ãƒ³</p>
            <p className="font-bold">
              {getPlanName(newPlan.type)} {newPlan.duration}ãƒ¶æœˆãƒ—ãƒ©ãƒ³
            </p>
            <p className="text-sm">Â¥{newPlan.price.toLocaleString()}/æœˆ</p>
          </div>

          <Separator />

          {/* ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå·®é¡ï¼‰è¡¨ç¤º */}
          <div className="bg-blue-50 p-4 rounded-md">
            <p className="text-sm font-semibold mb-2">ä»Šå›ã®ãŠæ”¯æ‰•ã„</p>

            {/* æ®‹ã‚ŠæœŸé–“ã®è¿”é‡‘ */}
            <div className="flex justify-between text-sm">
              <span>ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³è¿”é‡‘ï¼ˆ{subscriptionInfo.daysRemaining}æ—¥åˆ†ï¼‰</span>
              <span className="text-green-600">
                -Â¥{Math.abs(proration.refund).toLocaleString()}
              </span>
            </div>

            {/* æ–°ãƒ—ãƒ©ãƒ³ã®æ—¥å‰²ã‚Š */}
            <div className="flex justify-between text-sm">
              <span>æ–°ãƒ—ãƒ©ãƒ³ï¼ˆ{subscriptionInfo.daysRemaining}æ—¥åˆ†ï¼‰</span>
              <span>+Â¥{proration.newCharge.toLocaleString()}</span>
            </div>

            <Separator className="my-2" />

            {/* åˆè¨ˆ */}
            <div className="flex justify-between font-bold">
              <span>ä»Šå›ã®ãŠæ”¯æ‰•ã„åˆè¨ˆ</span>
              <span className={proration.total >= 0 ? 'text-red-600' : 'text-green-600'}>
                Â¥{Math.abs(proration.total).toLocaleString()}
                {proration.total < 0 ? ' è¿”é‡‘' : ''}
              </span>
            </div>
          </div>

          {/* æ¬¡å›ä»¥é™ã®è«‹æ±‚ */}
          <div>
            <p className="text-sm text-gray-600">
              æ¬¡å›è«‹æ±‚æ—¥: {format(subscriptionInfo.currentPeriodEnd, 'yyyyå¹´Mæœˆdæ—¥')}
            </p>
            <p className="text-sm text-gray-600">
              æ¬¡å›ä»¥é™: Â¥{newPlan.price.toLocaleString()}/æœˆ
            </p>
          </div>

          {/* æ³¨æ„äº‹é … */}
          <div className="bg-yellow-50 p-3 rounded-md">
            <p className="text-xs text-gray-700">
              âš ï¸ ãƒ—ãƒ©ãƒ³å¤‰æ›´ã‚’ç¢ºå®šã™ã‚‹ã¨ã€ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã€æ–°ã—ã„ãƒ—ãƒ©ãƒ³ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚
            </p>
          </div>
        </div>

        <DialogFooter>
          <Button variant="outline" onClick={onCancel}>
            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
          </Button>
          <Button onClick={onConfirm}>
            ãƒ—ãƒ©ãƒ³å¤‰æ›´ã‚’ç¢ºå®š
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
};
```

#### 2. ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯

```typescript
// src/utils/prorationType.ts

interface PlanInfo {
  type: PlanType;
  duration: 1 | 3;
  price: number; // æœˆé¡
}

interface ProrationResult {
  refund: number;      // ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³ã®è¿”é‡‘é¡ï¼ˆãƒã‚¤ãƒŠã‚¹å€¤ï¼‰
  newCharge: number;   // æ–°ãƒ—ãƒ©ãƒ³ã®æ—¥å‰²ã‚Šè«‹æ±‚é¡
  total: number;       // åˆè¨ˆï¼ˆrefund + newChargeï¼‰
}

export function calculateProration(
  currentPlan: PlanInfo,
  newPlan: PlanInfo,
  daysRemaining: number
): ProrationResult {
  // 1ãƒ¶æœˆã‚’30æ—¥ã¨ã—ã¦è¨ˆç®—
  const daysInMonth = 30;

  // ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³ã®æ—¥å‰²ã‚Šå˜ä¾¡
  const currentDailyRate = currentPlan.price / daysInMonth;

  // æ–°ãƒ—ãƒ©ãƒ³ã®æ—¥å‰²ã‚Šå˜ä¾¡
  const newDailyRate = newPlan.price / daysInMonth;

  // ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³ã®è¿”é‡‘é¡ï¼ˆãƒã‚¤ãƒŠã‚¹å€¤ï¼‰
  const refund = -(currentDailyRate * daysRemaining);

  // æ–°ãƒ—ãƒ©ãƒ³ã®æ—¥å‰²ã‚Šè«‹æ±‚é¡
  const newCharge = newDailyRate * daysRemaining;

  // åˆè¨ˆ
  const total = refund + newCharge;

  return {
    refund: Math.round(refund),
    newCharge: Math.round(newCharge),
    total: Math.round(total),
  };
}
```

#### 3. Subscription.tsxã®å¤‰æ›´

```typescript
// src/pages/Subscription.tsx

const [showConfirmModal, setShowConfirmModal] = useState(false);
const [selectedNewPlan, setSelectedNewPlan] = useState<PlanType | null>(null);

const handleSubscribe = async (selectedPlanType: PlanType) => {
  if (isSubscribed) {
    // æ—¢å­˜å¥‘ç´„è€… â†’ ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
    setSelectedNewPlan(selectedPlanType);
    setShowConfirmModal(true);
  } else {
    // æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ â†’ ç›´æ¥Checkoutã¸
    const returnUrl = window.location.origin + '/subscription';
    const { url, error } = await createCheckoutSession(returnUrl, selectedPlanType, selectedDuration);

    if (url) {
      window.location.href = url;
    }
  }
};

const handleConfirmPlanChange = async () => {
  setIsLoading(true);
  try {
    // Option 3ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨ï¼ˆäºŒé‡èª²é‡‘é˜²æ­¢ï¼‰
    const returnUrl = window.location.origin + '/subscription?updated=true';
    const { url, error } = await createCheckoutSession(
      returnUrl,
      selectedNewPlan!,
      selectedDuration
    );

    if (error) {
      throw error;
    }

    if (url) {
      window.location.href = url;
    }
  } catch (error) {
    toast({
      title: "ã‚¨ãƒ©ãƒ¼",
      description: "ãƒ—ãƒ©ãƒ³å¤‰æ›´ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
      variant: "destructive",
    });
  } finally {
    setIsLoading(false);
    setShowConfirmModal(false);
  }
};

return (
  <>
    {/* ... æ—¢å­˜ã®UI ... */}

    {/* ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« */}
    {showConfirmModal && selectedNewPlan && (
      <PlanChangeConfirmModal
        currentPlan={{
          type: planType!,
          duration: currentDuration!,
          price: getPlanPrice(planType!, currentDuration!),
        }}
        newPlan={{
          type: selectedNewPlan,
          duration: selectedDuration,
          price: getPlanPrice(selectedNewPlan, selectedDuration),
        }}
        subscriptionInfo={{
          currentPeriodEnd: subscriptionEndDate!, // check-subscriptionã‹ã‚‰å–å¾—
          daysRemaining: calculateDaysRemaining(subscriptionEndDate!),
        }}
        onConfirm={handleConfirmPlanChange}
        onCancel={() => setShowConfirmModal(false)}
      />
    )}
  </>
);
```

---

## ğŸ“Š æœ€çµ‚æ¯”è¼ƒ

| é …ç›® | Option 1 (Deep Link) | Option 2 (Option 3 + ç‹¬è‡ªUI) |
|------|---------------------|------------------------------|
| **ãƒã‚°ç™ºç”Ÿç¢ºç‡** | ğŸ”´ 35-60% | ğŸŸ¢ 20-35% |
| **äºŒé‡èª²é‡‘ãƒªã‚¹ã‚¯** | âš ï¸ ã‚ã‚Šï¼ˆ10-20%ï¼‰ | âœ… ãªã—ï¼ˆ0%ï¼‰ |
| **UIå®Ÿè£…ãƒŸã‚¹ãƒªã‚¹ã‚¯** | - | âš ï¸ ã‚ã‚Šï¼ˆ10-15%ã€ç›®è¦–ã§å³ç™ºè¦‹ï¼‰ |
| **ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º** | âœ… Stripeå…¬å¼UI | âœ… ç‹¬è‡ªUI |
| **å†ç™ºé˜²æ­¢ã®å®Ÿç¾æ€§** | ğŸŸ¡ ä¸­ï¼ˆ60-70%ï¼‰ | âœ… é«˜ï¼ˆ90%ä»¥ä¸Šï¼‰ |
| **Stripeä»•æ§˜å¤‰æ›´ã®å½±éŸ¿** | ğŸ”´ å¤§ãã„ | ğŸŸ¢ å°ã•ã„ |
| **å®Ÿè£…ã®è¤‡é›‘ã•** | ğŸŸ¢ ä½ | ğŸŸ¡ ä¸­ |
| **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§** | ğŸ”´ ä½ï¼ˆStripeä¾å­˜ï¼‰ | ğŸŸ¢ é«˜ï¼ˆè‡ªå‰å®Ÿè£…ï¼‰ |

---

## ğŸ¯ çµè«–

### æ¨å¥¨: **Option 2ï¼ˆOption 3 + ç‹¬è‡ªUIç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰**

**ç†ç”±**:
1. âœ… **ãƒã‚°ç™ºç”Ÿç¢ºç‡ãŒä½ã„**ï¼ˆ35-60% â†’ 20-35%ï¼‰
2. âœ… **äºŒé‡èª²é‡‘ãƒªã‚¹ã‚¯ãŒã‚¼ãƒ­**
3. âœ… **å†ç™ºé˜²æ­¢ãŒç¾å®Ÿçš„**ï¼ˆ90%ä»¥ä¸Šï¼‰
4. âœ… **Stripeä»•æ§˜å¤‰æ›´ã®å½±éŸ¿ã‚’å—ã‘ã«ãã„**
5. âœ… **ãƒã‚°ã¯ç›®è¦–ã§å³ç™ºè¦‹å¯èƒ½**

**ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•**:
- âš ï¸ UIå®Ÿè£…ãŒå¿…è¦ï¼ˆå·¥æ•°å¢—åŠ ï¼‰
- âš ï¸ ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…ãŒå¿…è¦

**ã—ã‹ã—**:
- UIå®Ÿè£…ãƒŸã‚¹ã¯**ç›®è¦–ãƒ†ã‚¹ãƒˆã§å³ç™ºè¦‹**ï¼ˆæ·±åˆ»åº¦: Mediumï¼‰
- ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒŸã‚¹ã¯**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ç™ºè¦‹**ï¼ˆæ·±åˆ»åº¦: Highã€ä½†ã—æ¤œå‡ºå®¹æ˜“ï¼‰
- äºŒé‡èª²é‡‘ï¼ˆæ·±åˆ»åº¦: Criticalã€æ¤œå‡ºå›°é›£ï¼‰ã‚ˆã‚Šã‚‚**åœ§å€’çš„ã«ãƒªã‚¹ã‚¯ãŒä½ã„**

---

## ğŸ“‹ Option 2å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: UIå®Ÿè£…
- [ ] `PlanChangeConfirmModal.tsx` ä½œæˆ
- [ ] ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£… (`calculateProration`)
- [ ] `Subscription.tsx` ã«ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«çµ±åˆ
- [ ] ãƒ‡ã‚¶ã‚¤ãƒ³ç¢ºèªï¼ˆFigmaã¾ãŸã¯ãƒ©ãƒ•ï¼‰

### Phase 2: ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç®—ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
  - [ ] Standard 1ãƒ¶æœˆ â†’ Feedback 1ãƒ¶æœˆï¼ˆ15æ—¥æ®‹ã‚Šï¼‰
  - [ ] Standard 1ãƒ¶æœˆ â†’ Standard 3ãƒ¶æœˆï¼ˆ20æ—¥æ®‹ã‚Šï¼‰
  - [ ] Feedback 1ãƒ¶æœˆ â†’ Standard 1ãƒ¶æœˆï¼ˆ10æ—¥æ®‹ã‚Šï¼‰
- [ ] UIè¡¨ç¤ºç¢ºèªï¼ˆç›®è¦–ãƒ†ã‚¹ãƒˆï¼‰
  - [ ] ãƒ—ãƒ­ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é‡‘é¡ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
  - [ ] æ¬¡å›è«‹æ±‚æ—¥ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
  - [ ] ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒé–‰ã˜ã‚‹
  - [ ] ç¢ºå®šãƒœã‚¿ãƒ³ã§Checkoutã«é·ç§»ã™ã‚‹

### Phase 3: å®Ÿç’°å¢ƒãƒ†ã‚¹ãƒˆ
- [ ] Test 2Bå®Ÿæ–½ï¼ˆStandard â†’ Feedbackï¼‰
- [ ] ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã®è¡¨ç¤ºå†…å®¹ç¢ºèª
- [ ] Checkoutå®Œäº†å¾Œã€Stripe Dashboardã§äºŒé‡èª²é‡‘ãƒã‚§ãƒƒã‚¯
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª

---

**æœ€çµ‚æ›´æ–°**: 2025-11-28
**æ¨å¥¨æ–¹å¼**: Option 2ï¼ˆOption 3 + ç‹¬è‡ªUIç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰
