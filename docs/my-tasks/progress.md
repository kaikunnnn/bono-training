# トレーニング機能 実装進捗状況

以下の内容はすでに終了のためコメントアウトします。
参考にするときに見ていただいても構いません

<!--
## 完了済みタスク

### Task 1: データベース構造
- ✅ `training`テーブル作成
- ✅ `task`テーブル作成
- ✅ `user_progress`テーブル作成
- ✅ `subscriptions`テーブルに`plan_members`列追加
- ✅ サンプルデータの挿入

### Task 2: サンプルデータと表示確認
- ✅ トレーニングデータの挿入
- ✅ タスクデータの挿入
- ✅ テスト用ユーザープログレスデータの挿入

### Task 3: トレーニング専用レイアウト
- ✅ Tailwind設定に`training`カラーテーマとデザイン変数を追加
- ✅ `TrainingLayout.tsx`の実装
- ✅ `/training/*`ルートへの適用

### Task 4: Training一覧ページ（カード＆タグフィルタ）
- ✅ 必要なAPI関数の実装
- ✅ カードコンポーネントの実装
- ✅ タグフィルタ機能の実装
- ✅ 一覧ページの動作確認

### Task 5: トレーニング詳細ページ（部分的に完了）
- ✅ `getTrainingDetail.ts` API実装
- ✅ `TaskList.tsx`コンポーネント実装
  - ✅ 有料/無料バッジ表示
  - ✅ サブスクリプション状態に応じた表示切り替え
- ⚠️ 進捗バー実装（Task 7に依存）

## 進行中のタスク

### Task 5: トレーニング詳細ページ（残りの部分）
- ⏳ 進捗バーの機能化（表示部分は実装済みだが、実際のデータ連携はTask 7依存）

### Task 8: サブスクリプション拡張（部分的に進行中）
- ⏳ `plan_members`と既存サブスクリプション判定の連携
- ⏳ プレミアムコンテンツのアクセス制御の完成

## 未実装タスク

### Task 6: タスク（お題）詳細ページ
- ❌ `/training/[slug]/[taskSlug]`ルート実装
- ❌ `getTaskDetail.ts` API実装
- ❌ `MdxPreview`コンポーネント実装
- ❌ `GateBanner`コンポーネントの調整
- ❌ プレミアムコンテンツのプレビュー制限機能
- ❌ MDXファイル管理構造の構築

### Task 7: 進捗保存と表示機能
- ❌ 進捗保存API実装（`POST /api/training/progress`）
- ❌ 進捗取得API実装（`GET /api/training/progress?trainingId=xxx`）
- ❌ RLSポリシー設定（`user_id = auth.uid()`）
- ❌ チェックボックスUI実装
- ❌ トレーニング詳細ページの進捗バー機能連携

### Task 8: サブスクリプション拡張（残りの部分）
- ❌ Stripe Webhookの調整（`plan_members=true`の設定）
- ❌ `/pricing`ページへの「Trainingも含まれる」文言追加

## 次に優先すべきタスク

1. **Task 6: タスク詳細ページ実装**
   - 詳細ページのルートとUIを作成
   - MDXプレビュー機能の実装
   - プレミアムコンテンツのアクセス制御

2. **Task 8: サブスクリプション拡張**
   - `plan_members`を既存サブスクリプション判定に統合
   - プレミアムコンテンツのアクセス制御を完成

3. **Task 7: 進捗保存と表示機能**
   - チェックボックスUI実装
   - 進捗保存API実装
   - 進捗バーの機能連携

## 実装メモ

- データベース構造（Task 1）は完全に実装済み
- `TaskList.tsx`は実装済みで、有料/無料表示の基本的な機能あり
- 進捗表示（チェックマーク）は見た目だけで機能していない
- Supabase側の`user_progress`テーブルは作成済みだがRLSポリシーは設定されていない
- `training`のTailwindテーマ設定は完成済み
- タスク詳細ページ（Task 6）とその進捗保存機能（Task 7）が現在のボトルネック

## 技術的課題と対応策

- MDXファイルの管理方法を確立する（`content/training/[training-slug]/[task-slug]/content.md`）
- RLSポリシーを適切に設定し、ユーザー権限の管理を行う
- 進捗状態の更新をリアルタイムに反映させる仕組みを構築する
- サブスクリプションの権限確認ロジックに`plan_members`を統合する -->
